<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Questioner | User | Meetup</title>
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/login.css">
    <link rel="stylesheet" href="../css/new.css">
    
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Anton" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/responsive.css">
    <link href="https://fonts.googleapis.com/css?family=Nunito+Sans" rel="stylesheet">
</head>

<body>
    <header class="header">
        <h1 class="header-logo"><a href="../index.html"><span class="q">Q</span><span class="uestioner">UESTIONER</span> </a> </h1>

        <div class="profile"> <a href="#"><img id="dropdown" src="../img/coming(1).jpeg" alt="">Admin</a>
            <br> <span class="time" id="currentTime"></span>
        </div>

        <div class="dropdown" id="dropdownNav">
            <ul>
                <li> <a href="../admin/meetups.html">Meetups</a> </li>
                <li> <a href="../admin-login.html">Logout</a> </li>
            </ul>
        </div>

</header>
    <!-- <div id="loader-overlay">
            <div class="loader"></div>
        </div> -->

    <section class="container">
        <div class="body-wrapper">
            <div class="container-page">
                <div class="topic-list-header center">CREATE MEETUP</div>
              
                <form action="" class="signupForm white-bg" id="meetupForm">
                    <div class="errorDiv" id="errorDiv"></div>
                    <div class="form-group">
                        <label for="firstname">Topic<span>*</span> </label>
                        <input type="text" name="topic" class="form-control">
                    </div>

                    <div class="form-group">
                        <label for="lastname">Location<span>*</span> </label>
                        <input type="text" name="location" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="othername">Happening On</label>
                        <input type="date" name="happeningOn" class="form-control">
                    </div>

                    <div class="form-group">
                        <label for="username">Details </label>
                        <input type="text"  name="details" class="form-control">
                    </div>

                    <div class="form-group">
                        <label for="host">Host<span>*</span> </label>
                        <input type="input"  name="host" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="password">Cover Image<span>*</span> </label>
                        <input type="file"  name="coverImage" class="form-control">
                    </div>
                   
                  
                    <div class="form-group">

                        
                        <button type="submit" name="createMeetup" class="submitButton" id="signup">CREATE </button>
                        <button  type="reset" class="cancelButton">CANCEL </button >
                       
                    </div>


                </form>
            </div>
            
        </div>
    </section>

    <footer class="footer">
        copyright @ Adebajo Oluwaseyi  | Andela 2018
    </footer>
    <script>
    
    document.querySelector('#meetupForm').addEventListener('submit', e => {
        
        e.preventDefault();
        let formData = new URLSearchParams( new FormData(e.target));
        
        fetch(`${localStorage.getItem('base_url')}/meetups` , {
            headers: {
                    'Authorization': `Bearer ${localStorage.getItem('adminToken')}`,
                },    
            method: "Post",
                body: formData,
            })
            .then(response => response.json())
            .then(data =>{
                console.log(data);
                
                if(data.status===201){
                   
                    
                    alert('new meetup created');
                    window.location.href = "../admin/meetups.html"
                    
             }
                else{
                    document.getElementById('errorDiv').innerHTML=null;
                    data.error.forEach(error => {
                        document.getElementById('errorDiv').innerHTML+=`
                        
                        <li>${error}</li>
                        ` ;
                    });
                    
                }
                

            })
            .catch(error=>console.log(error));
    })
</script>

    <script src="../js/general.js"></script>
</body>

</html>